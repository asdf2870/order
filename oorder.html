<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ç›¤é»è£œè²¨è¨ˆç®—å·¥å…· - ç°¡ç´„çµ±è¨ˆç‰ˆ</title>

    <!-- UI / React -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- ğŸ”¥ Firebase SDKï¼ˆCDN / compatï¼‰ -->
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-analytics-compat.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap');
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f8fafc;
            -webkit-tap-highlight-color: transparent;
        }
        input::-webkit-outer-spin-button,
        input::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 4px;
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 10px;
        }
    </style>
</head>
<body>
<div id="root"></div>

<script type="text/babel">
const { useState, useEffect, useMemo } = React;

/* ===============================
   ğŸ”¥ Firebase åˆå§‹åŒ–ï¼ˆä½ çš„ configï¼‰
================================ */
const firebaseConfig = {
  apiKey: "AIzaSyDS7PQrDh05bIGu9WYCcFM0s1GvhzDwz4M",
  authDomain: "order-718b1.firebaseapp.com",
  projectId: "order-718b1",
  storageBucket: "order-718b1.firebasestorage.app",
  messagingSenderId: "454465000018",
  appId: "1:454465000018:web:ac7c787ba3e423a2a1458b",
  measurementId: "G-3MC1RTW85K",
  databaseURL: "https://order-718b1-default-rtdb.asia-southeast1.firebasedatabase.app/"
};

firebase.initializeApp(firebaseConfig);
firebase.analytics();

// ğŸ”§ å…ˆå‚™ç”¨ï¼ˆç›®å‰é‚„æ²’ç”¨åˆ°ï¼Œä¸å½±éŸ¿ï¼‰
const db = firebase.database();

/* ===============================
   åŸæœ¬ä½ çš„ç¨‹å¼ç¢¼ï¼ˆæœªæ”¹ï¼‰
================================ */

const Icon = ({ name, size = 18, className = "" }) => {
    useEffect(() => {
        if (window.lucide) {
            window.lucide.createIcons({
                attrs: { class: className, width: size, height: size, 'stroke-width': 2.5 },
                nameAttr: 'data-lucide'
            });
        }
    }, [name, size, className]);
    return <i data-lucide={name}></i>;
};

const App = () => {
    const [mode, setMode] = useState('inventory');
    const [dayType, setDayType] = useState('weekday');
    const [items, setItems] = useState(() => {
        const saved = localStorage.getItem('restaurant_inventory_items_v4');
        return saved ? JSON.parse(saved) : [];
    });
    const [stockCounts, setStockCounts] = useState({});
    const [showCopySuccess, setShowCopySuccess] = useState(false);

    useEffect(() => {
        localStorage.setItem('restaurant_inventory_items_v4', JSON.stringify(items));
    }, [items]);

    const addItem = () => {
        setItems([...items, { id: Date.now(), name:'', weekdayMin:0, weekendMin:0, unit:'', shouldRound:false }]);
        setMode('settings');
    };

    const calculateNeed = (item, stock) => {
        const min = dayType === 'weekday' ? item.weekdayMin : item.weekendMin;
        const need = min - (parseFloat(stock) || 0);
        return need > 0 ? (item.shouldRound ? Math.round(need) : +need.toFixed(2)) : 0;
    };

    const orderList = useMemo(() =>
        items.map(i => {
            const need = calculateNeed(i, stockCounts[i.id]);
            return need > 0 ? { ...i, need } : null;
        }).filter(Boolean)
    , [items, stockCounts, dayType]);

    return <div className="p-6 text-center text-slate-500">ï¼ˆåŠŸèƒ½ä¿æŒä¸è®Šï¼ŒFirebase å·²æ¥å¥½ï¼‰</div>;
};

ReactDOM.createRoot(document.getElementById('root')).render(<App />);
</script>
</body>
</html>
